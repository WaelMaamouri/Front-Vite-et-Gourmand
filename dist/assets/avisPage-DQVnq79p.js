import{a as l}from"./index-Bn2YBzsb.js";function f(e){return new URLSearchParams(location.search).get(e)}function m(e){const t=Number.parseInt(String(e||""),10);return Number.isFinite(t)?t:0}function p(){const e=document.getElementById("avis-form");if(!e)return;const t=m(f("commandeId"));if(!t){alert("Commande introuvable : id manquant.");return}e.addEventListener("submit",async c=>{var o,s;c.preventDefault();const n=m((o=document.getElementById("avis-note"))==null?void 0:o.value),r=(((s=document.getElementById("avis-commentaire"))==null?void 0:s.value)||"").trim(),a=[];if((!n||n<1||n>5)&&a.push("note (1-5)"),r||a.push("commentaire"),a.length){alert("Champs invalides : "+a.join(", "));return}const u={commandeId:t,note:n,commentaire:r},i=e.querySelector('button[type="submit"]');i&&(i.disabled=!0);try{await l("/api/avis",u),alert("✅ Avis envoyé (en attente de validation) !"),e.reset()}catch(d){alert(d.message||"Erreur avis")}finally{i&&(i.disabled=!1)}})}export{p as loadAvisPage};
