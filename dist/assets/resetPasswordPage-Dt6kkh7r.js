import{a as i}from"./index-Bn2YBzsb.js";function d(){const e=new URLSearchParams(location.search).get("token");return e?e.trim():""}function m(){const e=document.getElementById("reset-form");if(!e)return;const t=d();if(!t){alert("Token manquant dans l’URL.");return}e.addEventListener("submit",async c=>{var o,n;c.preventDefault();const r=((o=document.getElementById("reset-password"))==null?void 0:o.value)||"",s=((n=document.getElementById("reset-password2"))==null?void 0:n.value)||"";if(!r||!s){alert("Veuillez remplir les deux champs.");return}if(r!==s){alert("Les mots de passe ne correspondent pas.");return}if(!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[^A-Za-z0-9]).{10,}$/.test(r)){alert("Mot de passe invalide (10+ caractères, maj, min, chiffre, spécial).");return}try{await i("/api/auth/reset-password",{token:t,password:r}),alert("✅ Mot de passe mis à jour, vous pouvez vous connecter."),window.location.href="/connexion"}catch(a){console.error(a),alert(a.message||"Erreur reset password")}})}export{m as bindResetPasswordForm};
